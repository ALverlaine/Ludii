(define "NoPieces" (all Sites (sites #1) if:(= 0 (count at:(site)))))

//------------------------------------------------------------------------------

(game "Owana"
    <Variant>
)

//------------------------------------------------------------------------------

(option "Variant" <Variant> args:{ <variant> }
    {
    (item "Owana (Ludii 1)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (if 
                    (is Proposed "End")
                    
                    (or 
                        (move Vote "End")
                        
                        (move Vote "No")
                    )
                    
                    (or 
                        (if 
                            (is Cycle)
                            
                            (move Propose "End")
                        )
                        
                        (move Select 
                            (from 
                                (if 
                                    (is Prev Mover)
                                    
                                    (sites { 
                                        (last To afterConsequence:True)
                                        }
                                    )
                                    
                                    (sites Mover)
                                )
                                if:
                                (< 0 
                                    (count at:
                                        (from)
                                    )
                                )
                            )
                            
                            (then 
                                (sow apply:
                                    (if 
                                        (and 
                                            (is In 
                                                (to)
                                                
                                                (sites Next)
                                            )
                                            
                                            (or 
                                                (= 
                                                    (count at:
                                                        (to)
                                                    )
                                                2)
                                                
                                                (= 
                                                    (count at:
                                                        (to)
                                                    )
                                                3)
                                            )
                                        )
                                        
                                        (fromTo 
                                            (from 
                                                (to)
                                            )
                                            
                                            (to 
                                                (handSite Mover)
                                            )
                                            count:
                                            (count at:
                                                (to)
                                            )
                                        )
                                        
                                        (if 
                                            (< 1 
                                                (count at:
                                                    (to)
                                                )
                                            )
                                            
                                            (moveAgain)
                                            
                                            (if 
                                                (and 
                                                    (is In 
                                                        (to)
                                                        
                                                        (sites Mover)
                                                    )
                                                    
                                                    (< 1 
                                                        (count at:
                                                            (if 
                                                                (is Mover P1)
                                                                
                                                                (+ 
                                                                    (to)
                                                                6)
                                                                
                                                                (- 
                                                                    (to)
                                                                6)
                                                            )
                                                        )
                                                    )
                                                )
                                                
                                                (fromTo 
                                                    (from 
                                                        (if 
                                                            (is Mover P1)
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                    
                                                    (to 
                                                        (handSite Mover)
                                                    )
                                                    count:
                                                    (count at:
                                                        (if 
                                                            (is Mover P1)
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    includeSelf:False backtracking:
                                    (and 
                                        (is In 
                                            (from)
                                            
                                            (sites Next)
                                        )
                                        
                                        (or 
                                            (= 
                                                (count at:
                                                    (from)
                                                )
                                            2)
                                            
                                            (= 
                                                (count at:
                                                    (from)
                                                )
                                            3)
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 1) ruleset.")
    
    (item "Owana (Ludii 2)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (if 
                    (is Proposed "End")
                    
                    (or 
                        (move Vote "End")
                        
                        (move Vote "No")
                    )
                    
                    (or 
                        (if 
                            (is Cycle)
                            
                            (move Propose "End")
                        )
                        
                        (do 
                            (move Select 
                                (from 
                                    (sites Mover)
                                    if:
                                    (< 0 
                                        (count at:
                                            (from)
                                        )
                                    )
                                )
                                
                                (then 
                                    (sow if:
                                        (and 
                                            (is In 
                                                (to)
                                                
                                                (sites Next)
                                            )
                                            
                                            (or 
                                                (= 
                                                    (count at:
                                                        (to)
                                                    )
                                                2)
                                                
                                                (= 
                                                    (count at:
                                                        (to)
                                                    )
                                                3)
                                            )
                                        )
                                        apply:
                                        (fromTo 
                                            (from 
                                                (to)
                                            )
                                            
                                            (to 
                                                (handSite Mover)
                                            )
                                            count:
                                            (count at:
                                                (to)
                                            )
                                        )
                                    includeSelf:False backtracking:True )
                                )
                            )
                            ifAfterwards:
                            (< 0 
                                (count in:
                                    (sites Next)
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 2) ruleset.")
    
    (item "Owana (Ludii 3)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (if 
                    (is Proposed "End")
                    
                    (or 
                        (move Vote "End")
                        
                        (move Vote "No")
                    )
                    
                    (or 
                        (if 
                            (is Cycle)
                            
                            (move Propose "End")
                        )
                        
                        (if 
                            (is Prev Mover)
                            
                            (move Select 
                                (from 
                                    (sites { 
                                        (last To afterConsequence:True)
                                        }
                                    )
                                )
                                
                                (then 
                                    (sow apply:
                                        (if 
                                            (< 1 
                                                (count at:
                                                    (to)
                                                )
                                            )
                                            
                                            (moveAgain)
                                            
                                            (if 
                                                (is In 
                                                    (to)
                                                    
                                                    (sites Mover)
                                                )
                                                
                                                (if 
                                                    (is Occupied 
                                                        (if 
                                                            (is Mover P1)
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                    
                                                    (fromTo 
                                                        (from 
                                                            (if 
                                                                (is Mover P1)
                                                                
                                                                (+ 
                                                                    (to)
                                                                6)
                                                                
                                                                (- 
                                                                    (to)
                                                                6)
                                                            )
                                                        )
                                                        
                                                        (to 
                                                            (handSite Mover)
                                                        )
                                                        count:
                                                        (count at:
                                                            (if 
                                                                (is Mover P1)
                                                                
                                                                (+ 
                                                                    (to)
                                                                6)
                                                                
                                                                (- 
                                                                    (to)
                                                                6)
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    includeSelf:False )
                                )
                            )
                            
                            (do 
                                (move Select 
                                    (from 
                                        (sites Mover)
                                        if:
                                        (is Occupied 
                                            (from)
                                        )
                                    )
                                    
                                    (then 
                                        (sow apply:
                                            (if 
                                                (< 1 
                                                    (count at:
                                                        (to)
                                                    )
                                                )
                                                
                                                (moveAgain)
                                                
                                                (if 
                                                    (is In 
                                                        (to)
                                                        
                                                        (sites Mover)
                                                    )
                                                    
                                                    (if 
                                                        (is Occupied 
                                                            (if 
                                                                (is Mover P1)
                                                                
                                                                (+ 
                                                                    (to)
                                                                6)
                                                                
                                                                (- 
                                                                    (to)
                                                                6)
                                                            )
                                                        )
                                                        
                                                        (fromTo 
                                                            (from 
                                                                (if 
                                                                    (is Mover P1)
                                                                    
                                                                    (+ 
                                                                        (to)
                                                                    6)
                                                                    
                                                                    (- 
                                                                        (to)
                                                                    6)
                                                                )
                                                            )
                                                            
                                                            (to 
                                                                (handSite Mover)
                                                            )
                                                            count:
                                                            (count at:
                                                                (if 
                                                                    (is Mover P1)
                                                                    
                                                                    (+ 
                                                                        (to)
                                                                    6)
                                                                    
                                                                    (- 
                                                                        (to)
                                                                    6)
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        includeSelf:False )
                                    )
                                )
                                ifAfterwards:
                                (if 
                                    (is Mover P1)
                                    
                                    (< 0 
                                        (count in:
                                            (sites P2)
                                        )
                                    )
                                    
                                    (< 0 
                                        (count in:
                                            (sites P1)
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 3) ruleset.")
    
    (item "Owana (Ludii 4)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (or { 
                    (move Select 
                        (from 
                            (if 
                                (= 0 
                                    (count Moves)
                                )
                                
                                (sites { 5}
                                )
                                
                                (if 
                                    (is Prev Mover)
                                    
                                    (sites { 
                                        (var "Replay")
                                        }
                                    )
                                    
                                    (sites Mover)
                                )
                            )
                            if:
                            (and 
                                (is Occupied 
                                    (from)
                                )
                                
                                (= 0 
                                    (state at:
                                        (from)
                                    )
                                )
                            )
                        )
                        
                        (then 
                            (sow apply:
                                (if 
                                    (< 1 
                                        (count at:
                                            (to)
                                        )
                                    )
                                    
                                    (if 
                                        (= 0 
                                            (state at:
                                                (to)
                                            )
                                        )
                                        
                                        (and 
                                            (moveAgain)
                                            
                                            (set Var "Replay" 
                                                (to)
                                            )
                                        )
                                    )
                                    
                                    (if 
                                        (is In 
                                            (to)
                                            
                                            (sites Mover)
                                        )
                                        
                                        (if 
                                            (!= 3 
                                                (count at:
                                                    (if 
                                                        (is In 
                                                            (to)
                                                            
                                                            (sites Bottom)
                                                        )
                                                        
                                                        (+ 
                                                            (to)
                                                        6)
                                                        
                                                        (- 
                                                            (to)
                                                        6)
                                                    )
                                                )
                                            )
                                            
                                            (if 
                                                (!= 0 
                                                    (count at:
                                                        (if 
                                                            (is In 
                                                                (to)
                                                                
                                                                (sites Bottom)
                                                            )
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                )
                                                
                                                (fromTo 
                                                    (from 
                                                        (if 
                                                            (is In 
                                                                (to)
                                                                
                                                                (sites Bottom)
                                                            )
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                    
                                                    (to 
                                                        (handSite Mover)
                                                    )
                                                    count:
                                                    (count at:
                                                        (if 
                                                            (is In 
                                                                (to)
                                                                
                                                                (sites Bottom)
                                                            )
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                )
                                            )
                                            
                                            (and { 
                                                (fromTo 
                                                    (from 
                                                        (if 
                                                            (is In 
                                                                (to)
                                                                
                                                                (sites Bottom )
                                                            )
                                                            
                                                            (+ 
                                                                (to)
                                                            6)
                                                            
                                                            (- 
                                                                (to)
                                                            6)
                                                        )
                                                    )
                                                    
                                                    (to 
                                                        (to)
                                                    )
                                                count:1 )
                                                
                                                (set State at:
                                                    (to)
                                                    
                                                    (mover)
                                                )
                                                
                                                (set State at:
                                                    (if 
                                                        (is In 
                                                            (to)
                                                            
                                                            (sites Bottom)
                                                        )
                                                        
                                                        (+ 
                                                            (to)
                                                        6)
                                                        
                                                        (- 
                                                            (to)
                                                        6)
                                                    )
                                                    
                                                    (mover)
                                                )
                                                }
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                    }
                    
                    (then 
                        (if 
                            (and 
                                (not 
                                    (is Next Mover)
                                )
                                
                                (or 
                                    (all Sites 
                                        (sites P1)
                                        if:
                                        (or 
                                            (!= 0 
                                                (state at:
                                                    (site)
                                                )
                                            )
                                            
                                            (is Empty 
                                                (site)
                                            )
                                        )
                                    )
                                    
                                    (all Sites 
                                        (sites P2)
                                        if:
                                        (or 
                                            (!= 0 
                                                (state at:
                                                    (site)
                                                )
                                            )
                                            
                                            (is Empty 
                                                (site)
                                            )
                                        )
                                    )
                                )
                            )
                            
                            (and { 
                                (forEach Site 
                                    (sites P1)
                                    
                                    (if 
                                        (= 0 
                                            (state at:
                                                (site)
                                            )
                                        )
                                        
                                        (fromTo 
                                            (from 
                                                (site)
                                            )
                                            
                                            (to 
                                                (handSite P1)
                                            )
                                            count:
                                            (count at:
                                                (site)
                                            )
                                        )
                                    )
                                )
                                
                                (forEach Site 
                                    (sites P2)
                                    
                                    (if 
                                        (= 0 
                                            (state at:
                                                (site)
                                            )
                                        )
                                        
                                        (fromTo 
                                            (from 
                                                (site)
                                            )
                                            
                                            (to 
                                                (handSite P2)
                                            )
                                            count:
                                            (count at:
                                                (site)
                                            )
                                        )
                                    )
                                )
                                
                                (forEach Site 
                                    (sites Board)
                                    
                                    (if 
                                        (= 
                                            (state at:
                                                (site)
                                            )
                                        P1)
                                        
                                        (fromTo 
                                            (from 
                                                (site)
                                            )
                                            
                                            (to 
                                                (handSite P1)
                                            )
                                            count:
                                            (count at:
                                                (site)
                                            )
                                        )
                                        
                                        (if 
                                            (= 
                                                (state at:
                                                    (site)
                                                )
                                            P2)
                                            
                                            (fromTo 
                                                (from 
                                                    (site)
                                                )
                                                
                                                (to 
                                                    (handSite P2)
                                                )
                                                count:
                                                (count at:
                                                    (site)
                                                )
                                            )
                                        )
                                    )
                                )
                                }
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 4) ruleset.")
    
    (item "Owana (Ludii 5)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (do 
                    (move Select 
                        (from 
                            (if 
                                (is Prev Mover)
                                
                                (sites { 
                                    (last To afterConsequence:True)
                                    }
                                )
                                
                                (sites Mover)
                            )
                            if:
                            (< 0 
                                (count at:
                                    (from)
                                )
                            )
                        )
                        
                        (then 
                            (sow apply:
                                (if 
                                    (and 
                                        (is In 
                                            (to)
                                            
                                            (sites Next)
                                        )
                                        
                                        (= 
                                            (count at:
                                                (to)
                                            )
                                        4)
                                    )
                                    
                                    (fromTo 
                                        (from 
                                            (to)
                                        )
                                        
                                        (to 
                                            (handSite Mover)
                                        )
                                        count:
                                        (count at:
                                            (to)
                                        )
                                        
                                        (then 
                                            (forEach Site 
                                                (if 
                                                    (is Mover P1)
                                                    
                                                    (sites P2)
                                                    
                                                    (sites P1)
                                                )
                                                
                                                (if 
                                                    (= 
                                                        (count at:
                                                            (site)
                                                        )
                                                    4)
                                                    
                                                    (fromTo 
                                                        (from 
                                                            (site)
                                                        )
                                                        
                                                        (to 
                                                            (handSite Mover)
                                                        )
                                                        count:
                                                        (count at:
                                                            (site)
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                    
                                    (if 
                                        (< 1 
                                            (count at:
                                                (to)
                                            )
                                        )
                                        
                                        (moveAgain)
                                    )
                                )
                            includeSelf:False )
                        )
                    )
                    ifAfterwards:
                    (< 0 
                        (count in:
                            (if 
                                (is Mover P1)
                                
                                (sites P2)
                                
                                (sites P1)
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 5) ruleset.")
    
    (item "Owana (Ludii 6)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (or { 
                    (move Select 
                        (from 
                            (if 
                                (is Prev Mover)
                                
                                (sites { 
                                    (var "Replay")
                                    }
                                )
                                
                                (sites Mover)
                            )
                            if:
                            (and 
                                (is Occupied 
                                    (from)
                                )
                                
                                (= 0 
                                    (state at:
                                        (from)
                                    )
                                )
                            )
                        )
                        
                        (then 
                            (sow apply:
                                (if 
                                    (!= 0 
                                        (state at:
                                            (to)
                                        )
                                    )
                                    
                                    (if 
                                        (= 
                                            (next)
                                            
                                            (state at:
                                                (to)
                                            )
                                        )
                                        
                                        (and 
                                            (fromTo 
                                                (from 
                                                    (to)
                                                )
                                                
                                                (to 
                                                    (handSite Mover)
                                                )
                                                count:
                                                (min 2 
                                                    (count at:
                                                        (to)
                                                    )
                                                )
                                            )
                                            
                                            (set State at:
                                                (to)
                                                
                                                (next)
                                            )
                                        )
                                    )
                                    
                                    (if 
                                        (and 
                                            (is In 
                                                (to)
                                                
                                                (sites Next)
                                            )
                                            
                                            (= 4 
                                                (count at:
                                                    (to)
                                                )
                                            )
                                        )
                                        
                                        (and 
                                            (set State at:
                                                (to)
                                                
                                                (mover)
                                            )
                                            
                                            (set State at:
                                                (if 
                                                    (is In 
                                                        (to)
                                                        
                                                        (sites Bottom)
                                                    )
                                                    
                                                    (+ 
                                                        (to)
                                                    6)
                                                    
                                                    (- 
                                                        (to)
                                                    6)
                                                )
                                                
                                                (mover)
                                            )
                                        )
                                        
                                        (if 
                                            (< 1 
                                                (count at:
                                                    (to)
                                                )
                                            )
                                            
                                            (and 
                                                (moveAgain)
                                                
                                                (set Var "Replay" 
                                                    (to)
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                    }
                    
                    (then 
                        (if 
                            (and 
                                (not 
                                    (is Next Mover)
                                )
                                
                                (or 
                                    (all Sites 
                                        (sites P1)
                                        if:
                                        (or 
                                            (!= 0 
                                                (state at:
                                                    (site)
                                                )
                                            )
                                            
                                            (is Empty 
                                                (site)
                                            )
                                        )
                                    )
                                    
                                    (all Sites 
                                        (sites P2)
                                        if:
                                        (or 
                                            (!= 0 
                                                (state at:
                                                    (site)
                                                )
                                            )
                                            
                                            (is Empty 
                                                (site)
                                            )
                                        )
                                    )
                                )
                            )
                            
                            (and { 
                                (forEach Site 
                                    (sites P1)
                                    
                                    (if 
                                        (= 0 
                                            (state at:
                                                (site)
                                            )
                                        )
                                        
                                        (fromTo 
                                            (from 
                                                (site)
                                            )
                                            
                                            (to 
                                                (handSite P1)
                                            )
                                            count:
                                            (count at:
                                                (site)
                                            )
                                        )
                                    )
                                )
                                
                                (forEach Site 
                                    (sites P2)
                                    
                                    (if 
                                        (= 0 
                                            (state at:
                                                (site)
                                            )
                                        )
                                        
                                        (fromTo 
                                            (from 
                                                (site)
                                            )
                                            
                                            (to 
                                                (handSite P2)
                                            )
                                            count:
                                            (count at:
                                                (site)
                                            )
                                        )
                                    )
                                )
                                
                                (forEach Site 
                                    (sites Board)
                                    
                                    (if 
                                        (= 
                                            (state at:
                                                (site)
                                            )
                                        P1)
                                        
                                        (and 
                                            (fromTo 
                                                (from 
                                                    (site)
                                                )
                                                
                                                (to 
                                                    (handSite P1)
                                                )
                                                count:
                                                (count at:
                                                    (site)
                                                )
                                            )
                                            
                                            (set State at:
                                                (site)
                                            0)
                                        )
                                        
                                        (if 
                                            (= 
                                                (state at:
                                                    (site)
                                                )
                                            P2)
                                            
                                            (and 
                                                (fromTo 
                                                    (from 
                                                        (site)
                                                    )
                                                    
                                                    (to 
                                                        (handSite P2)
                                                    )
                                                    count:
                                                    (count at:
                                                        (site)
                                                    )
                                                )
                                                
                                                (set State at:
                                                    (site)
                                                0 )
                                            )
                                        )
                                    )
                                )
                                }
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 6) ruleset.")
    
    (item "Owana (Ludii 7)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (move Select 
                    (from 
                        (if 
                            (is Prev Mover)
                            
                            (sites { 
                                (trackSite Move from:
                                    (last To afterConsequence:True)
                                steps:1 )
                                }
                            )
                            
                            (sites Mover)
                        )
                        if:
                        (< 0 
                            (count at:
                                (from)
                            )
                        )
                    )
                    
                    (then 
                        (sow apply:
                            (if 
                                (> 
                                    (count at:
                                        (trackSite Move from:
                                            (to)
                                        steps:1)
                                    )
                                0 )
                                
                                (moveAgain)
                                
                                (if 
                                    (> 
                                        (count at:
                                            (if 
                                                (is In 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                    
                                                    (sites Bottom)
                                                )
                                                
                                                (+ 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                                
                                                (- 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                            )
                                        )
                                    0 )
                                    
                                    (fromTo 
                                        (from 
                                            (if 
                                                (is In 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                    
                                                    (sites Bottom)
                                                )
                                                
                                                (+ 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                                
                                                (- 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                            )
                                        )
                                        
                                        (to 
                                            (handSite Mover)
                                        )
                                        count:
                                        (count at:
                                            (if 
                                                (is In 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                    
                                                    (sites Bottom)
                                                )
                                                
                                                (+ 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                                
                                                (- 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                7 )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 7) ruleset.")
    
    (item "Owana (Ludii 8)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (or { 
                    (move Select 
                        (from 
                            (if 
                                (is Prev Mover)
                                
                                (sites { 
                                    (var "Replay")
                                    }
                                )
                                
                                (sites Mover)
                            )
                            if:
                            (is Occupied 
                                (from)
                            )
                        )
                        
                        (then 
                            (sow apply:
                                (if 
                                    (not 
                                        (and 
                                            (is In 
                                                (to)
                                                
                                                (sites Next)
                                            )
                                            
                                            (= 
                                                (next)
                                                
                                                (state at:
                                                    (to)
                                                )
                                            )
                                        )
                                    )
                                    
                                    (if 
                                        (= 3 
                                            (count at:
                                                (to)
                                            )
                                        )
                                        
                                        (and { 
                                            (fromTo 
                                                (from 
                                                    (to)
                                                )
                                                
                                                (to 
                                                    (trackSite Move from:
                                                        (to)
                                                    steps:1 )
                                                )
                                            count:3 )
                                            
                                            (sow 
                                                (trackSite Move from:
                                                    (to)
                                                steps:1 )
                                                count:3 skipIf:
                                                (and 
                                                    (is In 
                                                        (to)
                                                        
                                                        (sites Mover)
                                                    )
                                                    
                                                    (= 1 
                                                        (state at:
                                                            (to)
                                                        )
                                                    )
                                                )
                                            )
                                            
                                            (set State at:
                                                (to)
                                            1)
                                            }
                                        )
                                        
                                        (if 
                                            (< 1 
                                                (count at:
                                                    (to)
                                                )
                                            )
                                            
                                            (and 
                                                (moveAgain)
                                                
                                                (set Var "Replay" 
                                                    (to)
                                                )
                                            )
                                        )
                                    )
                                )
                                skipIf:
                                (and 
                                    (is In 
                                        (to)
                                        
                                        (sites Mover)
                                    )
                                    
                                    (= 
                                        (mover)
                                        
                                        (state at:
                                            (to)
                                        )
                                    )
                                )
                            )
                        )
                    )
                    }
                    
                    (then 
                        (forEach Site 
                            (if 
                                (is Mover P1)
                                
                                (sites P2)
                                
                                (sites P1)
                            )
                            
                            (if 
                                (= 1 
                                    (state at:
                                        (site)
                                    )
                                )
                                
                                (and 
                                    (fromTo 
                                        (from 
                                            (site)
                                        )
                                        
                                        (to 
                                            (centrePoint)
                                        )
                                        count:
                                        (count at:
                                            (site)
                                        )
                                    )
                                    
                                    (set State at:
                                        (site)
                                    1)
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 8) ruleset.")
    
    (item "Owana (Ludii 9)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (move Select 
                    (from 
                        (sites Mover)
                    )
                    
                    (then 
                        (sow "Track" owner:
                            (mover)
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 9) ruleset.")
    
    (item "Owana (Ludii 10)" <
        
        (players 2)
        
        (equipment { 
            (mancalaBoard 2 4 
                (track "Track" "1,E,N,W" loop:True)
            )
            
            (regions P1 
                (sites Bottom)
            )
            
            (regions P2 
                (sites Top)
            )
            
            (piece "Seed" Shared)
            
            (hand Each)
            }
        )
        
        (rules 
            (start 
                (set Count 4 to:
                    (sites Track)
                )
            )
            
            (play 
                (move Select 
                    (from 
                        (sites Mover)
                        if:
                        (> 
                            (count at:
                                (from)
                            )
                        1)
                    )
                    
                    (then 
                        (sow apply:
                            (if 
                                (or 
                                    (= 2 
                                        (count at:
                                            (to)
                                        )
                                    )
                                    
                                    (= 3 
                                        (count at:
                                            (to)
                                        )
                                    )
                                )
                                
                                (and { 
                                    (fromTo 
                                        (from 
                                            (to)
                                        )
                                        
                                        (to 
                                            (handSite Mover)
                                        )
                                        count:
                                        (count at:
                                            (to)
                                        )
                                    )
                                    
                                    (if 
                                        (!= 
                                            (to)
                                            
                                            (ahead 
                                                (to)
                                            E)
                                        )
                                        
                                        (if 
                                            (or 
                                                (= 2 
                                                    (count at:
                                                        (ahead 
                                                            (to)
                                                        E)
                                                    )
                                                )
                                                
                                                (= 3 
                                                    (count at:
                                                        (ahead 
                                                            (to)
                                                        E)
                                                    )
                                                )
                                            )
                                            
                                            (fromTo 
                                                (from 
                                                    (ahead 
                                                        (to)
                                                    E)
                                                )
                                                
                                                (to 
                                                    (handSite Mover)
                                                )
                                                count:
                                                (count at:
                                                    (ahead 
                                                        (to)
                                                    E)
                                                )
                                            )
                                        )
                                    )
                                    
                                    (if 
                                        (!= 
                                            (to)
                                            
                                            (ahead 
                                                (to)
                                            W)
                                        )
                                        
                                        (if 
                                            (or 
                                                (= 2 
                                                    (count at:
                                                        (ahead 
                                                            (to)
                                                        W)
                                                    )
                                                )
                                                
                                                (= 3 
                                                    (count at:
                                                        (ahead 
                                                            (to)
                                                        W)
                                                    )
                                                )
                                            )
                                            
                                            (fromTo 
                                                (from 
                                                    (ahead 
                                                        (to)
                                                    W)
                                                )
                                                
                                                (to 
                                                    (handSite Mover)
                                                )
                                                count:
                                                (count at:
                                                    (ahead 
                                                        (to)
                                                    W)
                                                )
                                            )
                                        )
                                    )
                                    }
                                )
                            )
                        )
                    )
                )
            )
            
            (end { 
                (if 
                    (all Sites 
                        (sites P1)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P2 Win)
                )
                
                (if 
                    (all Sites 
                        (sites P2)
                        if:
                        (= 0 
                            (count at:
                                (site)
                            )
                        )
                    )
                    
                    (result P1 Win)
                )
                }
            )
        )
        
    > "The Owana (Ludii 10) ruleset.")
    
    (item "Incomplete"
        <
        (players 2) 
        
        (equipment { 
            (mancalaBoard 2 4
                (track "Track" "1,E,N,W" loop:True)
            )  
            (regions P1 (sites Bottom))      // P1 home
            (regions P2 (sites Top))      // P2 home
            (piece "Seed" Shared)
            (hand Each)
        }) 
        (rules 
            (start (set Count 4 to:(sites Track)))
            
            (play [#])
            
            (end {
                (if ("NoPieces" P1) (result P2 Win)) 
                (if ("NoPieces" P2) (result P1 Win)) 
            })
        )
        >
        "The incomplete ruleset."
    )
    
})

//------------------------------------------------------------------------------

(rulesets {
    
    (ruleset "Ruleset/Owana (Ludii 1) (Reconstructed)" {
        "Variant/Owana (Ludii 1)"
    })
    (ruleset "Ruleset/Owana (Ludii 2) (Reconstructed)" {
        "Variant/Owana (Ludii 2)"
    })
    (ruleset "Ruleset/Owana (Ludii 3) (Reconstructed)" {
        "Variant/Owana (Ludii 3)"
    })
    (ruleset "Ruleset/Owana (Ludii 4) (Reconstructed)" {
        "Variant/Owana (Ludii 4)"
    })
    (ruleset "Ruleset/Owana (Ludii 5) (Reconstructed)" {
        "Variant/Owana (Ludii 5)"
    })
    (ruleset "Ruleset/Owana (Ludii 6) (Reconstructed)" {
        "Variant/Owana (Ludii 6)"
    })
    (ruleset "Ruleset/Owana (Ludii 7) (Reconstructed)" {
        "Variant/Owana (Ludii 7)"
    })
    (ruleset "Ruleset/Owana (Ludii 8) (Reconstructed)" {
        "Variant/Owana (Ludii 8)"
    })
    (ruleset "Ruleset/Owana (Ludii 9) (Reconstructed)" {
        "Variant/Owana (Ludii 9)"
    })
    (ruleset "Ruleset/Owana (Ludii 10) (Reconstructed)" {
        "Variant/Owana (Ludii 10)"
    })
    
    (ruleset "Ruleset/Historical Information (Incomplete)" {
        "Variant/Incomplete"
    })
    
})

//------------------------------------------------------------------------------

(metadata 
    (info
        {
        (id "1349")
        }
    )
    
    (graphics {
        (board Style Mancala)
    })
    
    (recon {
        (concept "Sow" True)
    })
)

