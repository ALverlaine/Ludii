(game "Russian Fortress Chess"
		 (players 4) 
		    (equipment { 
		    	(board 
		    		(merge {
		    		(square 4)
		    		(shift 2 2 (square 12))
		    		(shift 12 0 (square 4))
		    		(shift 0 12 (square 4))
		    		(shift 12 12 (square 4))
		    		})
		    	)
		        (piece "Disc" Shared)
		        (piece "King" Each)
		        (piece "Queen" Each)
		        (piece "Knight" Each)
		        (piece "Bishop" Each)
		        (piece "Rook" Each)
		        (piece "Pawn" Each)
		        (hand Each size:3)
		        (regions "ExtraSquare" P1 (expand origin:181 steps:3))
		        (regions "ExtraSquare" P2 (expand origin:191 steps:3))
		        (regions "ExtraSquare" P3 (expand origin:174 steps:3))
		        (regions "ExtraSquare" P4 (expand origin:0 steps:3))
		    })
		   (rules 
				  (start {
					  (place "Disc" Edge (sites {26 35 278 279 300 325 88 89}))
					  (set Team 1 {P1 P3})
					  (set Team 2 {P2 P4})
					  (place "King1" coord:"H14") (place "King2" coord:"N9")
					  (place "King3" coord:"I3")  (place "King4" coord:"C8")
					  (place "Queen1" coord:"I14") (place "Queen2" coord:"N8")
					  (place "Queen3" coord:"H3")  (place "Queen4" coord:"C9")
					  (place "Bishop1" (sites {"G14" "J14"})) (place "Bishop2" (sites {"N7" "N10"}))
					  (place "Bishop3" (sites {"G3" "J3"}))    (place "Bishop4" (sites {"C10" "C7"}))
					  (place "Knight1" (sites {"F14" "K14"})) (place "Knight2" (sites {"N6" "N11"}))
					  (place "Knight3" (sites {"F3" "K3"}))  (place "Knight4" (sites {"C11" "C6"}))
					  (place "Rook1" (sites {"E14" "L14"})) (place "Rook2" (sites {"N5" "N12"}))
					  (place "Rook3" (sites {"E3" "L3"}))    (place "Rook4" (sites {"C12" "C5"}))
					  (place "Pawn1" (sites {"E13".."L13"})) (place "Pawn2" (sites {"M5".."M12"}))
					  (place "Pawn3" (sites {"E4".."L4"}))   (place "Pawn4" (sites {"D5".."D12"}))
					  (place "Bishop1" (handSite P1)) (place "Bishop2" (handSite P2))
					  (place "Bishop3" (handSite P3)) (place "Bishop4" (handSite P4))
					  (place "Knight1" (handSite P1 1)) (place "Knight2" (handSite P2 1))
					  (place "Knight3" (handSite P3 1))  (place "Knight4" (handSite P4 1))
					  (place "Rook1" (handSite P1 2)) (place "Rook2" (handSite P2 2))
					  (place "Rook3" (handSite P3 2))    (place "Rook4" (handSite P4 2))
				  })
				  phases:
				  {
			   		(phase "Placing"
			   			(play
			   				(forEach Site (sites Hand Mover)
			   					(if (is Occupied (site))
			   						(move
			   							(from (site))
			   						    (to (intersection (sites Empty) (sites Mover "ExtraSquare")))
			   						)
			   					)
			   				)
			   			)
			   			(nextPhase Mover (= 0 (count Pieces Mover in:(sites Hand Mover))) "Playing")
			   		)
			   		(phase "Playing"
			   			(play
			   				(forEach Piece)
			   			)
			   		)
				  }
				  (end (if ("NoPiece" Mover) (result Mover Win)))
				 )
)

//------------------------------------------------------------------------------

(metadata 
  
  (info
      {
      }
  )
  
  (graphics {
      (piece Scale "Pawn" 0.825)
      (piece Colour "Disc" fillColour:(colour Hidden) strokeColour:(colour Hidden) secondaryColour:(colour Hidden))
      (show Line {{14 24} {146 148} {52 54} {156 182} {20 22} {32 185} {158 218} {216 174}} (colour Black) scale:2)
      (piece Families {"Defined" "Microsoft" "Pragmata" "Symbola"})
      (board Checkered)
      (board StyleThickness OuterEdges 2.0)
      (board Colour Phase0 (colour Green))
      (board Colour Phase1 (colour Yellow))
      (board Colour InnerEdges (colour Black))
      (player Colour P1 (colour Red))
      (player Colour P2 (colour Blue))
      (player Colour P3 (colour White))
      (player Colour P4 (colour VeryDarkGrey))
  })
  
)
